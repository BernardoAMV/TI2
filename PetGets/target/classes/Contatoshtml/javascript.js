// Dados do JSON
const json = [
   
  {
    "image": "../imagens/Caoviver.jpeg",
    "name": "Cao Viver",
    "distance": "25",
    "address": "Endereço do Cao Viver",
    "website": "www.caoviver.com",
    "email": "contato@caoviver.com",
    "phone": "(00) 0000-1111",
    "descricao": " Com o objetivo de acolher e abrigar cães e gatos em situação de risco e abandono, a Associação Cãoviver em Defesa dos Animais foi oficialmente fundada em agosto de 2003. O abrigo, instalado em um sítio inicialmente preparado para abrigar alguns poucos animais (o espaço foi utilizado no passado como estação de manejo destinada ao tratamento, reabilitação e reinserção a fauna de jaguatiricas apreendidas nas ações do IBAMA MG), hoje abriga mais de uma centena de cães e algumas dezenas de gatos. Durante todos esses anos de atividade, foram milhares de animais resgatados, muitos sem possibilidade de salvação, pois, via de regra, foram vítimas de abandono, atropelamento, espancamento dentre vários outros tipos de maus-tratos."
  },
  {
    "image": "../imagens/PetSmartlogo.jpeg",
    "name": "PetSmart",
    "distance": "5",
    "address": "Endereço do PetSmart",
    "website": "www.petsmart.com",
    "email": "contato@petsmart.com",
    "phone": "(00) 1111-2222",
    "descricao": " Com o objetivo de acolher e abrigar cães e gatos em situação de risco e abandono, a Associação Cãoviver em Defesa dos Animais foi oficialmente fundada em agosto de 2003. O abrigo, instalado em um sítio inicialmente preparado para abrigar alguns poucos animais (o espaço foi utilizado no passado como estação de manejo destinada ao tratamento, reabilitação e reinserção a fauna de jaguatiricas apreendidas nas ações do IBAMA MG), hoje abriga mais de uma centena de cães e algumas dezenas de gatos. Durante todos esses anos de atividade, foram milhares de animais resgatados, muitos sem possibilidade de salvação, pois, via de regra, foram vítimas de abandono, atropelamento, espancamento dentre vários outros tipos de maus-tratos."
    
  },
  {
    "image": "../imagens/RockBicho.jpeg",
    "name": "RockBicho",
    "distance": "2",
    "address": "Endereço do RockBicho",
    "website": "www.rockbicho.com",
    "email": "contato@rockbicho.com",
    "phone": "(00) 3333-4444",
    "descricao": " Com o objetivo de acolher e abrigar cães e gatos em situação de risco e abandono, a Associação Cãoviver em Defesa dos Animais foi oficialmente fundada em agosto de 2003. O abrigo, instalado em um sítio inicialmente preparado para abrigar alguns poucos animais (o espaço foi utilizado no passado como estação de manejo destinada ao tratamento, reabilitação e reinserção a fauna de jaguatiricas apreendidas nas ações do IBAMA MG), hoje abriga mais de uma centena de cães e algumas dezenas de gatos. Durante todos esses anos de atividade, foram milhares de animais resgatados, muitos sem possibilidade de salvação, pois, via de regra, foram vítimas de abandono, atropelamento, espancamento dentre vários outros tipos de maus-tratos."
  },
  {
    "image": "../imagens/gatocafe.jpeg",
    "name": "GatoCafé",
    "distance": "2",
    "address": "Endereço do GatoCafé",
    "website": "www.gatocafe.com",
    "email": "contato@gatocafe.com",
    "phone": "(00) 5555-6666",
    "descricao": " São cafeterias que unem amor ao café e, também, afeição pelos gatos, colocando os frequentadores para interagirem com os felinos enquanto consomem a bebida. Percebemos a oportunidade de unir a proposta dos cat cafés com adoção e ajuda os gatinhos. A ideia já estava no coração, era impossível ver um gatinho na rua e saber que tínhamos a solução para ajudá-lo. Foi aí então que ficou decidido, o Gato Café tinha que acontecer! Nosso propósito é ajudar os gatinhos a encontrarem uma família, e que eles vivam em um ambiente incrível enquanto aguardam o seu tão sonhado lar! Queremos desmistificar as questões que existem em relação aos gatos e provar para o mundo como esses seres são perfeitos (mas aposto que isso você já sabe, né?)."
  },
  {
    "image": "../imagens/HumaneSociety.jpeg",
    "name": "Humane Society",
    "distance": "20",
    "address": "Endereço do Humane Society",
    "website": "www.humanesociety.com",
    "email": "contato@humanesociety.com",
    "phone": "(00) 7777-8888",
    "descricao": " Com o objetivo de acolher e abrigar cães e gatos em situação de risco e abandono, a Associação Cãoviver em Defesa dos Animais foi oficialmente fundada em agosto de 2003. O abrigo, instalado em um sítio inicialmente preparado para abrigar alguns poucos animais (o espaço foi utilizado no passado como estação de manejo destinada ao tratamento, reabilitação e reinserção a fauna de jaguatiricas apreendidas nas ações do IBAMA MG), hoje abriga mais de uma centena de cães e algumas dezenas de gatos. Durante todos esses anos de atividade, foram milhares de animais resgatados, muitos sem possibilidade de salvação, pois, via de regra, foram vítimas de abandono, atropelamento, espancamento dentre vários outros tipos de maus-tratos."
  },
  {
    "image": "../imagens/ProjetoCaomer.jpeg",
    "name": "Projeto Cãomer",
    "distance": "15",
    "address": "Endereço do Projeto Cãomer",
    "website": "www.projetocaomer.com",
    "email": "contato@projetocaomer.com",
    "phone": "(00) 9999-0000",
    "descricao": " O Projeto Cãomer foi iniciado no ano de 2015 por uma moradora do bairro Jardim Canadá, Kely Alves, que perdeu um animal por atropelamento e começou a pensar em quem cuidava dos animais que passavam por essas situações e não tinham ninguém para acolhê-los. Todos os animais regatados são encaminhados ao médico veterinário, fazem uma bateria de exames, recebem vermífugo, remédio para pulgas e carrapatos, são vacinados e quando chegam à idade certa, são castrados. Só são disponibilizados para adoção animais que estão com a saúde em perfeito estado. Até o ano de 2019 conseguimos realizar mais de 900 adoções de cães e gatos."
  },
  {
    "image": "../imagens/cantinhodafilo.jpeg",
    "name": "Cantinho da Filó",
    "distance": "30",
    "address": "Endereço do Cantinho da Filó",
    "website": "www.cantinhodafilo.com",
    "email": "contato@cantinhodafilo.com",
    "phone": "(00) 1234-5678",
    "descricao": " O “CANTINHO DA FILÓ” é um abrigo temporário para cães e gatos de rua.Atualmente, estamos sob a nossa guarda mais de 270 animais entre cães e gatos, e todos eles passam por avaliação médica ao chegarem ao Abrigo. São vermifugados, tomam antiparasitários e, caso estejam saudáveis, iniciamos imediatamente as vacinas antirrábica e antiviróticas (V4 para os gatos e V10 para os cães), todas importadas. Caso estejam com algum problema de saúde, são submetidos a tratamento para só depois serem vacinados. Ah, e todos possuem cartões de vacinação!"
  },
  {
    "image": "../imagens/balaiodegato.jpeg",
    "name": "Balaio de Gato",
    "distance": "5",
    "address": "Endereço do Balaio de Gato",
    "website": "www.balaiodegato.com",
    "email": "contato@balaiodegato.com",
    "phone": "(00) 2468-1357",
    "descricao": " O Abrigo Balaio de Gato, é um projeto independente de Minas Gerais, no qual ajudamos a resgatar, providenciamos tratamento veterinário e realizamos adoções de maneira responsável a cães e gatos recolhidos das ruas da capital, Belo Horizonte. Hoje mantemos aproximadamente 200 animais sob nossa responsabilidade e como não conseguimos resgatar e salvar a todos, trabalhamos também fazendo uma conscientização e orientação da população para que pessoas que encontrem um animal em perigo possam ajudar e também fazer a diferença! Atuamos de forma independente e voluntária, não contando com recursos governamentais e sobrevivendo graças ao apoio de voluntários; membros da Sociedade das Patinhas; apadrinhamentos; Parceiros do Balaio  e de colaborações esporádicas de pessoas que acreditam em nosso trabalho."
  },
  {
    "image": "../imagens/miaudota.jpeg",
    "name": "MiauDota",
    "distance": "5",
    "address": "Endereço do MiauDota",
    "website": "www.miaudota.com",
    "email": "contato@miaudota.com",
    "phone": "(00) 9876-5432",
    "descricao": " Com o objetivo de acolher e abrigar cães e gatos em situação de risco e abandono, a Associação Cãoviver em Defesa dos Animais foi oficialmente fundada em agosto de 2003. O abrigo, instalado em um sítio inicialmente preparado para abrigar alguns poucos animais (o espaço foi utilizado no passado como estação de manejo destinada ao tratamento, reabilitação e reinserção a fauna de jaguatiricas apreendidas nas ações do IBAMA MG), hoje abriga mais de uma centena de cães e algumas dezenas de gatos. Durante todos esses anos de atividade, foram milhares de animais resgatados, muitos sem possibilidade de salvação, pois, via de regra, foram vítimas de abandono, atropelamento, espancamento dentre vários outros tipos de maus-tratos."
  }
  ];
  
  // Função para criar os elementos de card
  function createCard(image, name, distance, address, website, email, phone, descricao) {
    const cardDiv = document.createElement('div');
    cardDiv.className = 'card';
  
    const cardImage = document.createElement('img');
    cardImage.className = 'card-image';
    cardImage.src = image;
    cardImage.alt = 'Imagem do Card';
    cardDiv.appendChild(cardImage);
  
    const cardContent = document.createElement('div');
    cardContent.className = 'card-content';
    cardDiv.appendChild(cardContent);
  
    const cardTitle = document.createElement('h3');
    cardTitle.className = 'card-title';
    cardTitle.textContent = 'Nome: ' + name;
    cardContent.appendChild(cardTitle);
  
    const cardDistance = document.createElement('h3');
    cardDistance.className = 'card-distance';
    cardDistance.textContent = 'Distância: ' + distance + ' km';
    cardContent.appendChild(cardDistance);
  
    const cardButton = document.createElement('button');
    cardButton.className = 'card-button';
    cardButton.textContent = 'Contatar';
    cardContent.appendChild(cardButton);
  
    cardButton.addEventListener('click', function () {
      const overlay = document.createElement('div');
      overlay.className = 'overlay1';
  
      const popup = document.createElement('div');
      popup.className = 'popup';
  
      const closeButton = document.createElement('button');
      closeButton.className = 'close-button';
      closeButton.textContent = 'X';
  
      const popupImage = document.createElement('img');
      popupImage.className = 'popup-image';
      popupImage.src = image;
      popupImage.alt = 'Imagem da Casa de Adoção';
  
      const popupContent = document.createElement('div');
      popupContent.className = 'popup-content';
  
      const popupTitle = document.createElement('h3');
      popupTitle.className = 'popup-title';
      popupTitle.textContent = name;
  
      const popupDistance = document.createElement('p');
      popupDistance.className = 'popup-distance';
      popupDistance.textContent = 'Distância: ' + distance + ' km';
  
      const popupAddress = document.createElement('p');
      popupAddress.textContent = 'Endereço: ' + address;
  
      const popupWebsite = document.createElement('p');
      popupWebsite.textContent = 'Website: ' + website;
  
      const popupEmail = document.createElement('p');
      popupEmail.textContent = 'Email: ' + email;
  
      const popupPhone = document.createElement('p');
      popupPhone.textContent = 'Telefone: ' + phone;
  
      const popupDescription = document.createElement('p');
      popupDescription.className = 'popup-description';
      popupDescription.textContent = 'Descrição: ' + descricao;
  
      popupContent.appendChild(popupTitle);
      popupContent.appendChild(popupDistance);
      popupContent.appendChild(popupAddress);
      popupContent.appendChild(popupWebsite);
      popupContent.appendChild(popupEmail);
      popupContent.appendChild(popupPhone);
      popupContent.appendChild(popupDescription);
  
      popup.appendChild(closeButton);
      popup.appendChild(popupImage);
      popup.appendChild(popupContent);
  
      overlay.appendChild(popup);
  
      document.body.appendChild(overlay);
  
      closeButton.addEventListener('click', function () {
        document.body.removeChild(overlay);
      });
    });
  
    return cardDiv;
  }
  
// Função para adicionar os cards na página
function addCardsToPage(jsonData) {
  const cardsContainer = document.querySelector('.background');

  for (let i = 0; i < jsonData.length; i++) {
    const card = createCard(
      jsonData[i].image,
      jsonData[i].name,
      jsonData[i].distance,
      jsonData[i].address,
      jsonData[i].website,
      jsonData[i].email,
      jsonData[i].phone,
      jsonData[i].descricao
    );
    cardsContainer.appendChild(card);
  }
}

// Chamando a função para adicionar os cards na página
addCardsToPage(json);
  


  function filterCards(searchTerm) {
    const cardsContainer = document.querySelector('.background');
    cardsContainer.innerHTML = ''; // Limpa os cards existentes
  
    if (searchTerm === '') {
      addCardsToPage(json); // Exibe todos os cards quando o campo de pesquisa está vazio
      return;
    }
  
    const filteredData = json.filter((item) =>
      item.name.toLowerCase().includes(searchTerm.toLowerCase())
    );
  
    addCardsToPage(filteredData);
  }
  
  // Evento de submissão do formulário de pesquisa
  const searchForm = document.querySelector('form');
  searchForm.addEventListener('submit', function (event) {
    event.preventDefault();
    const searchInput = document.getElementById('searchInput');
    const searchTerm = searchInput.value;
    filterCards(searchTerm);
  });
  
  // Evento de input no campo de pesquisa
  const searchInput = document.getElementById('searchInput');
  searchInput.addEventListener('input', function () {
    const searchTerm = searchInput.value;
    filterCards(searchTerm);
  });

  
  function showCadastro() {
    const overlay = document.querySelector('.overlay');
    const cadastro = document.querySelector('.cadastro');
  
    overlay.classList.add('show');
    cadastro.classList.remove('hidden');
  }
  
  document.addEventListener('click', function (event) {
    const overlay = document.querySelector('.overlay');
    const cadastro = document.querySelector('.cadastro');
  
    if (event.target === overlay) {
      overlay.classList.remove('show');
      cadastro.classList.add('hidden');
    }
  });
  
  document.addEventListener('DOMContentLoaded', function () {
    var loginButton = document.querySelector('.login');
    var cadastroDiv = document.querySelector('.cadastro');
    var overlayDiv = document.querySelector('.overlay');
  
    loginButton.addEventListener('click', function () {
      cadastroDiv.classList.add('show');
      overlayDiv.style.display = 'flex';
    });
  
    overlayDiv.addEventListener('click', function (event) {
      if (event.target === overlayDiv) {
        cadastroDiv.classList.remove('show');
        overlayDiv.style.display = 'none';
      }
    });
  
    
  
    // Adiciona um evento de clique ao botão "Criar conta Instituição"
    var botaoCriarConta = document.getElementById("criarConta");
    botaoCriarConta.addEventListener("click", salvarDados);
  
    // Adiciona um evento de clique ao botão "Entrar"
    var btnEntrar = document.getElementById('btnLoginInstituicao');
    btnEntrar.addEventListener('click', showCadastro);
  });
      
      function salvarDados() {
        // Recupera os valores dos campos de texto
        var nomeInstituicao = document.getElementById("nomeInstituicao1234").value;
        var cnpj = document.getElementById("cnpjInputInstituicao").value;
        var senha = document.getElementById("senhaInputInstituicao").value;
        var contato = document.getElementById("emailInstituicao").value;
      
        // Verifica se os campos estão preenchidos
        if (nomeInstituicao && cnpj && senha && contato) {
          // Cria um objeto com os dados
          var dados = {
            nomeDaInstituicao: nomeInstituicao,
            cnpjInstituicao: cnpj,
            senhaInstituicao: senha,
            emailInstituicao: contato
          };
          var dadosJSON = JSON.stringify(dados);

          // Salva os dados no localStorage
          localStorage.setItem("dadosDaInstituicao", dadosJSON);

      
          // Converte o objeto em uma string JSON
          const options = {
            method : 'POST',
            body : dadosJSON
      
          };

          var usuarios = fetch('http://localhost:5554/Instituicao/insert', options)
      .then(response => response.json())
      .then(data => {
          console.log('Usuário inserido com sucesso:', data);
          window.location.href = '../HomePage/logado.html';

      })
      .catch(error => {
          console.error('Erro ao inserir usuário:', error);
      });
      
          // Exibe uma mensagem de sucesso
          alert("Conta criada com sucesso!");
      

          
      
          var cadastroDiv = document.querySelector('.cadastro');
          var overlayDiv = document.querySelector('.overlay');
      
          cadastroDiv.remove();
          overlayDiv.style.display = 'none';
      
      
        } else {
          // Exibe uma mensagem de erro se algum campo estiver vazio
          alert("Preencha todos os campos do formulário.");
        }
      }
      
      async function validarLogin(){

  var loginCnpj = document.getElementById("loginCnpjInstituicao").value;
  var loginSenha = document.getElementById("loginSenhaInstituicao").value;

  let usuario = {
    cnpjInstituicao : loginCnpj,
    senhaInstituicao : loginSenha 
    

  };

  const dados = {
    method : 'POST',
    body : JSON.stringify(usuario)

  };
  
  
  await fetch('http://localhost:5554/Instituicao/validate', dados)
  .then(data => data.json())
  .then(data => {
    
     if (data.validated) {

      const dadosJSON = {
        nome : data.nomeInstituicao,
        contato : data.contato,
        cpf : data.cnpj
      }
      
      console.log(dadosJSON)
      alert("Login feito com sucesso, bem-vindo!");
      
      localStorage.setItem("dadosUser", JSON.stringify(dadosJSON));
      window.location.href = '../HomePage/logado.html';

      
    } else {
      alert("Usuário não encontrado");
      window.location.href = '../index.html';
    }
  })
  .catch(error => {
    alert("Erro na solicitação ou comunicação com o servidor");
    
  });
}